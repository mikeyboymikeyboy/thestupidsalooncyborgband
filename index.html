<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Stupid Saloon Cyborg Band</title>
    <link rel="stylesheet" href="style.css">
    <link id="theme-style" rel="stylesheet" href="skins/western/style.css">
</head>
<body>
    <div id="game">
        <p>Loading story...</p>
    </div>
    
    <canvas id="comicCanvas" style="display: none;"></canvas>
    
    <div id="comicSvgWrapper" style="display: none;">
        <svg viewBox="0 0 2048 2860" width="1024" xmlns="http://www.w3.org/2000/svg">
            <defs>
                <pattern id="inkTexture" patternUnits="userSpaceOnUse" width="6" height="6">
                    <path d="M0,0 L6,6 M6,0 L0,6" stroke="#111" stroke-width="0.5"/>
                </pattern>

                <clipPath id="panel1"><polygon points="17,1079 17,639 18,254 497,252 537,252 538,253 541,259 601,381 808,802 926,1042 942,1075 942,1079"/></clipPath>
                <clipPath id="panel2"><polygon points="582,252 793,252 2046,253 2046,281 2044,1066 2043,1077 1947,1078 1712,1079 1208,1080 986,1080 962,1032 756,613 609,314 582,259"/></clipPath>
                <clipPath id="panel3"><polygon points="1871,1120 2044,1120 2044,1962 1787,1992 1744,1997 1390,2038 1295,2049 1269,2052 1261,2052 1261,2050 1266,1225 1267,1124 1268,1123"/></clipPath>
                <clipPath id="panel4"><polygon points="19,2197 19,2075 20,1123 1221,1121 1221,1203 1217,1935 1216,2055 965,2085 898,2093 40,2195 23,2197"/></clipPath>
                <clipPath id="panel5"><polygon points="18,2859 18,2239 1233,2099 1390,2081 1643,2052 1992,2012 2027,2008 2036,2007 2044,2007 2044,2859"/></clipPath>
            </defs>

            <image x="-76" y="169" width="1110" height="992" clip-path="url(#panel1)" preserveAspectRatio="xMidYMid slice" crossorigin="anonymous" />
            <image x="436" y="170" width="1756" height="993" clip-path="url(#panel2)" preserveAspectRatio="xMidYMid slice" crossorigin="anonymous" />
            <image x="1183" y="1027" width="939" height="1118" clip-path="url(#panel3)" preserveAspectRatio="xMidYMid slice" crossorigin="anonymous" />
            <image x="-101" y="1014" width="1442" height="1291" clip-path="url(#panel4)" preserveAspectRatio="xMidYMid slice" crossorigin="anonymous" />
            <image x="-184" y="1922" width="2431" height="1022" clip-path="url(#panel5)" preserveAspectRatio="xMidYMid slice" crossorigin="anonymous" />

            <g class="panel-shadow" fill="url(#inkTexture)" stroke="black" stroke-width="15">
                <polygon points="17,1079 17,639 18,254 497,252 537,252 538,253 541,259 601,381 808,802 926,1042 942,1075 942,1079"/>
                <polygon points="582,252 793,252 2046,253 2046,281 2044,1066 2043,1077 1947,1078 1712,1079 1208,1080 986,1080 962,1032 756,613 609,314 582,259"/>
                <polygon points="1871,1120 2044,1120 2044,1962 1787,1992 1744,1997 1390,2038 1295,2049 1269,2052 1261,2052 1261,2050 1266,1225 1267,1124 1268,1123"/>
                <polygon points="19,2197 19,2075 20,1123 1221,1121 1221,1203 1217,1935 1216,2055 965,2085 898,2093 40,2195 23,2197"/>
                <polygon points="18,2859 18,2239 1233,2099 1390,2081 1643,2052 1992,2012 2027,2008 2036,2007 2044,2007 2044,2859"/>
            </g>
        </svg>
    </div>

    <script src="https://unpkg.com/pdf-lib"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvg@3.0.10/lib/umd.min.js"></script>
    <script src="storyengine.js" type="module"></script>
    
    <script>
        window.addEventListener('storyengine-loaded', function() {
            window.StoryEngine.init({
                storyPath: 'story.json',
                skin: 'western'
            });
        });
    </script>
</body>
</html>